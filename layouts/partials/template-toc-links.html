<ul id="markdown-toc">

{{/* Scratch variable built up in 'blocks.html' represents full parsed page from
captured variables */}}
{{ $section := $.ctx.Scratch.Get "page" }}

{{ $headers := findRE "<h2.*?>(.|\n)*?</h2>" $section }}
{{ range $headers }}
{{ $id := . | strings.TrimPrefix "<h2 id=\"" }}
{{ $id := $id | replaceRE "\">.*" "" }}
{{ $header := . | replaceRE "</?h2.*?>" "" | htmlUnescape | safeHTML }}
<li><a href="#{{ $id }}">{{ $header }}</a></li>
{{ end }}
</ul>